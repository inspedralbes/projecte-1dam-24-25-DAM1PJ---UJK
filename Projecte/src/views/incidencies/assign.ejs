<%- include('../partials/header', { title: 'Assignar tècnic a incidència' }) %>

<div class="container mt-4">
  <h1>Assignar tècnic</h1>

  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <h5 class="card-title">Incidència ID: <%= incidencia.id_incidencia %></h5>
      <p><strong>Descripció:</strong> <%= incidencia.descripcio %></p>
      <p><strong>Departament:</strong> <%= incidencia.Departament?.nom || 'No assignat' %></p>
      <p><strong>Prioritat:</strong> <%= incidencia.prioritat %></p>
    </div>
  </div>

  <form action="/incidencies/assignar/<%= incidencia.id_incidencia %>" method="POST">
    <div class="mb-3">
      <label for="id_tecnic" class="form-label">Selecciona un tècnic</label>
      <select name="id_tecnic" id="id_tecnic" class="form-select" required>
        <option value="">-- Selecciona --</option>
        <% tecnics.forEach(tecnic => { %>
          <option value="<%= tecnic.id_tecnic %>"><%= tecnic.nom %></option>
        <% }) %>
      </select>
    </div>

    <div class="mb-3">
      <label for="descripcio" class="form-label">Comentari (opcional)</label>
      <textarea name="descripcio" id="descripcio" class="form-control" rows="3"></textarea>
    </div>

    <button type="submit" class="btn btn-success">Assignar tècnic</button>
  </form>
</div>

<%- include('../partials/footer') %>

